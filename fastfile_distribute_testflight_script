# Copy this to Fastfile in your fastlane
default_platform(:ios)

# Do not change the outputName variable value. It's paired bitrise scripts.
outputPath = "./build"
outputName = "ipa"

platform :ios do
  # Not work for bitrise
  lane :build_and_testflight do
    increment_build_number
    gym(
      output_directory: outputPath,
      output_name: outputName
    )
    upload_to_testflight(
      skip_waiting_for_build_processing: true,
      uses_non_exempt_encryption: false,
      # Skip submission only prevents fastlane from sending the build for external testing review.
      skip_submission: true,
      ipa: outputPath + "/" + outputName + ".ipa"
    )
  end
  lane :bump_and_build do
    increment_build_number
    gym(
      output_directory: outputPath,
      output_name: outputName + ".ipa"
    )
  end
end